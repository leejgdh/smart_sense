# Mosquitto MQTT Broker Configuration for SmartSense
# Updated: 2025-10-28

# ===== General Settings =====
persistence true
persistence_location /mosquitto/data/

# ===== Logging =====
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type all
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# ===== MQTT Protocol (Port 1883) =====
listener 1883
protocol mqtt
allow_anonymous true
# password_file /mosquitto/config/passwd  # TODO: Enable for production

# ===== WebSocket Support (Port 9001) =====
listener 9001
protocol websockets
allow_anonymous true

# ===== Queue & Message Settings =====
max_queued_messages 1000
max_inflight_messages 100
max_packet_size 10485760

# ===== Connection Settings =====
max_connections -1
max_keepalive 65535

# ===== Persistence Settings =====
autosave_interval 300
autosave_on_changes false

# ===== Security (Production) =====
# TODO: Uncomment for production
# acl_file /mosquitto/config/acl.conf
# password_file /mosquitto/config/passwd

# ===== TLS/SSL (Production) =====
# TODO: Uncomment for production
# listener 8883
# protocol mqtt
# cafile /mosquitto/config/ca.crt
# certfile /mosquitto/config/server.crt
# keyfile /mosquitto/config/server.key
